{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user within a tenant.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "tenantId": {
          "type": "string",
          "description": "Reference to Tenant. (Relationship: Tenant 1:N User)"
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "firstName": {
          "type": "string",
          "description": "User's first name."
        },
        "lastName": {
          "type": "string",
          "description": "User's last name."
        },
        "subscriptionId": {
          "type": "string",
          "description": "Reference to Subscription. (Relationship: Subscription 1:N User)"
        },
        "roles": {
          "type": "array",
          "description": "User's roles",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "tenantId",
        "email"
      ]
    },
    "Tenant": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tenant",
      "type": "object",
      "description": "Represents a company or organization using the ERP system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the tenant."
        },
        "name": {
          "type": "string",
          "description": "Name of the tenant."
        },
        "domain": {
          "type": "string",
          "description": "Domain name associated with the tenant."
        },
        "subscriptionId": {
          "type": "string",
          "description": "Reference to Subscription. (Relationship: Subscription 1:N Tenant)"
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Transaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transaction",
      "type": "object",
      "description": "Represents a financial transaction.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the transaction."
        },
        "tenantId": {
          "type": "string",
          "description": "Reference to Tenant. (Relationship: Tenant 1:N Transaction)"
        },
        "date": {
          "type": "string",
          "description": "Date of the transaction.",
          "format": "date-time"
        },
        "amount": {
          "type": "number",
          "description": "Amount of the transaction."
        },
        "type": {
          "type": "string",
          "description": "Type of transaction (e.g., 'sale', 'purchase')."
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N Transaction)"
        },
        "signature": {
          "type": "string",
          "description": "RKSV signature for the transaction."
        },
        "qrCode": {
          "type": "string",
          "description": "RKSV QR code data for the transaction."
        },
        "source": {
          "type": "string",
          "description": "Source of the transaction (e.g., 'pos-shop', 'wolt', 'foodora')."
        },
        "status": {
          "type": "string",
          "description": "Status of the transaction (e.g., 'pending', 'completed')."
        }
      },
      "required": [
        "id",
        "tenantId",
        "date",
        "amount",
        "type"
      ]
    },
    "Product": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Product",
      "type": "object",
      "description": "Represents a product or service.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the product."
        },
        "tenantId": {
          "type": "string",
          "description": "Reference to Tenant. (Relationship: Tenant 1:N Product)"
        },
        "name": {
          "type": "string",
          "description": "Name of the product."
        },
        "description": {
          "type": "string",
          "description": "Description of the product."
        },
        "price": {
          "type": "number",
          "description": "Price of the product."
        }
      },
      "required": [
        "id",
        "tenantId",
        "name",
        "price"
      ]
    },
    "Plan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Plan",
      "type": "object",
      "description": "Represents a subscription plan.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the plan."
        },
        "name": {
          "type": "string",
          "description": "Name of the plan (e.g., 'Free', 'Standard')."
        },
        "price": {
          "type": "number",
          "description": "Price of the plan."
        },
        "features": {
          "type": "array",
          "description": "Features included in the plan.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "price"
      ]
    },
    "Subscription": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Subscription",
      "type": "object",
      "description": "Represents a user subscription to a particular plan.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the subscription."
        },
        "planId": {
          "type": "string",
          "description": "Reference to Plan. (Relationship: Plan 1:N Subscription)"
        },
        "startDate": {
          "type": "string",
          "description": "Date when the subscription started.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "Date when the subscription ends.",
          "format": "date-time"
        },
        "tenantId": {
          "type": "string",
          "description": "Reference to Tenant. (Relationship_ Tenant 1:N Subscription)"
        }
      },
      "required": [
        "id",
        "planId",
        "startDate",
        "endDate"
      ]
    },
    "UserTenant": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserTenant",
      "type": "object",
      "description": "Maps a user's UID to their tenant ID.",
      "properties": {
        "tenantId": {
          "type": "string",
          "description": "The ID of the tenant the user belongs to."
        }
      },
      "required": [
        "tenantId"
      ]
    },
    "Settings": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Settings",
      "type": "object",
      "description": "Represents tenant-specific settings.",
      "properties": {
        "companyName": {
          "type": "string",
          "description": "The name of the company."
        },
        "themeColor": {
          "type": "string",
          "description": "The primary color for the UI theme."
        }
      }
    },
    "ModuleSettings": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Module Settings",
      "type": "object",
      "description": "Represents the enabled/disabled state of various application modules for a tenant.",
      "properties": {
        "posShop": {
          "type": "boolean",
          "description": "Point of Sale (Shop)"
        },
        "posRestaurant": {
          "type": "boolean",
          "description": "Point of Sale (Restaurant)"
        },
        "calendar": {
          "type": "boolean",
          "description": "Calendar Module"
        },
        "kiosk": {
          "type": "boolean",
          "description": "Kiosk Mode"
        },
        "aiAssistant": {
          "type": "boolean",
          "description": "AI Assistant"
        }
      }
    },
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "Represents a single message in an AI chat.",
      "properties": {
        "text": {
          "type": "string",
          "description": "The content of the message."
        },
        "role": {
          "type": "string",
          "description": "The role of the message sender.",
          "enum": [
            "user",
            "model"
          ]
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "The time the message was sent."
        }
      },
      "required": [
        "text",
        "role",
        "timestamp"
      ]
    },
    "RKSVKey": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "RKSV Key",
      "type": "object",
      "description": "Represents the RKSV signing key information for a tenant.",
      "properties": {
        "publicKey": {
          "type": "string",
          "description": "The public key for transaction signature verification."
        },
        "rksvActive": {
          "type": "boolean",
          "description": "Flag indicating if RKSV signing is active for the tenant."
        },
        "lastSignature": {
          "type": "string",
          "description": "The signature of the most recent transaction, used for chaining."
        }
      },
      "required": [
        "publicKey",
        "rksvActive",
        "lastSignature"
      ]
    },
    "Integration": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Integration",
      "type": "object",
      "description": "Stores credentials and status for a third-party integration.",
      "properties": {
        "apiKey": {
          "type": "string",
          "description": "Encrypted API key for the third-party service."
        },
        "connectedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the integration was connected."
        },
        "lastSync": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of the last successful data sync."
        },
        "status": {
          "type": "string",
          "enum": [
            "active",
            "disconnected",
            "error"
          ],
          "description": "The current status of the integration."
        }
      },
      "required": [
        "apiKey",
        "connectedAt",
        "status"
      ]
    },
    "POSOrder": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "POS Order",
      "type": "object",
      "description": "Represents an order originating from an external Point-of-Sale or delivery platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the order, usually from the external platform."
        },
        "tenantId": {
          "type": "string",
          "description": "The tenant this order belongs to."
        },
        "customer": {
          "type": "object",
          "description": "Customer information."
        },
        "items": {
          "type": "array",
          "description": "The items included in the order."
        },
        "totalAmount": {
          "type": "number",
          "description": "The total amount of the order."
        },
        "paymentType": {
          "type": "string",
          "description": "How the order was paid (e.g., 'card', 'cash_on_delivery')."
        },
        "source": {
          "type": "string",
          "description": "The platform the order originated from (e.g., 'wolt', 'foodora')."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp of when the order was placed."
        }
      },
      "required": [
        "id",
        "tenantId",
        "totalAmount",
        "source",
        "timestamp"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/UserTenant"
      },
      "description": "Top-level collection to map user UIDs to tenant IDs for security rules."
    },
    "/tenants/{tenantId}": {
      "schema": {
        "$ref": "#/entities/Tenant"
      },
      "description": "Collection to store tenant information."
    },
    "/tenants/{tenantId}/users/{userId}": {
      "schema": {
        "$ref": "#/entities/User"
      },
      "description": "Sub-collection for users within a tenant."
    },
    "/tenants/{tenantId}/transactions/{transactionId}": {
      "schema": {
        "$ref": "#/entities/Transaction"
      },
      "description": "Sub-collection for transactions within a tenant."
    },
    "/tenants/{tenantId}/products/{productId}": {
      "schema": {
        "$ref": "#/entities/Product"
      },
      "description": "Sub-collection for products within a tenant."
    },
    "/tenants/{tenantId}/settings/general": {
      "schema": {
        "$ref": "#/entities/Settings"
      },
      "description": "Document for general settings within a tenant."
    },
    "/tenants/{tenantId}/settings/modules": {
      "schema": {
        "$ref": "#/entities/ModuleSettings"
      },
      "description": "Document for module settings within a tenant."
    },
    "/tenants/{tenantId}/settings/rksv": {
      "schema": {
        "$ref": "#/entities/RKSVKey"
      },
      "description": "Document for RKSV key and status within a tenant."
    },
    "/tenants/{tenantId}/integrations/{platformId}": {
      "schema": {
        "$ref": "#/entities/Integration"
      },
      "description": "Stores credentials and status for third-party integrations like Wolt or Foodora."
    },
    "/global/plans/{planId}": {
      "schema": {
        "$ref": "#/entities/Plan"
      },
      "description": "Global collection for subscription plans."
    },
    "/tenants/{tenantId}/aiChats/{chatId}/messages/{messageId}": {
      "schema": {
        "$ref": "#/entities/ChatMessage"
      },
      "description": "Sub-collection for messages within an AI chat session."
    },
    "/tenants/{tenantId}/posOrders/{orderId}": {
      "schema": {
        "$ref": "#/entities/POSOrder"
      },
      "description": "Sub-collection for orders from external POS/delivery platforms."
    }
  }
}